# 7. 셸 스크립트 프로그래밍

## 7.1 셸의 기본

커널에게 명령을 내리게 하는 부분, 명령 전달하는 영역

하드웨어 정보 커널 통해서 확인해서 화면에 뿌려주는 영역

--> 셸이라고 함 

### 7.1.1 CentOS의 bash 셸

CentOS에서 기본적으로 사용하는 셸은 bash셸.  '배시 셸'이라고 읽으며 Boume Shell 을 기반으로 Korn Shell과 C Shell 의 좋은 점을 합한 것임

**bash의 특징:**

- Alias 기능
- History 기능
- 연산 기능
- Job Control 기능
- 자동 이름 완성 기능
- 프롬프트 제어 기능
- 명령 편집 기능

커널 위에 있는 OS 위에서 커널에게 VJ card 잡아라 등의 명령어 내림

### 7.1.2 셸의 명령문 처리 방법

셸 명령문은 명령문과 함께 여러 가지 옵션이 인자를 사용할 수 있음.

### 7.1.3 환경 변수

설정된 환경 변수는 'echo $환경 변수이름' 형식으로 명령어를 실행하면 확인 가능함.

``` 변수 설명
HOME	현재 사용자의 홈 디렉터리
LANG	기본 지원되는 언어
TERM 	로그인 터미널 타입
USER	현재 사용자의 이름
COLUMNS 현재 터미널의 컬럼 수 
BASH	bash 셸의 경로
PATH	실행 파일을 찾는 디렉터리 경로 
USERNAME	현재 사용자 이름 
```



### 7.2.2 변수

**변수의 기본:**

- 변수를 사용하기 전에 미리 선언하지 않음, 처음 변수에 값이 할당되면 자동으로 변수 생성됨.
- 변수에 넣는 모든 값은 문자열로 취급함. 숫자를 넣어도 문자로 취급함.(중요)
- 변수 이름은 대소문자를 구분함.
- = 좌우에는 공백 없어야 함. 
- 변수 이름은 대소문자 구분함. 숫자를 넣어도 문자로 취급함.

**변수의 입력과 출력:**

- '$'라는 문자가 들어간 글자를 출력하려면 ''로 묶어주거나 앞에 \를 붙여야 함.
- ""로 변수를 묶어도 되고 안 묶어도 된다. 

**숫자 계산:**

- 변수에 넣은 값은 모두 문자열로 취급함. 

- 변수에 들어있는 값에 '+', '-','*','/' 등의 연산을 하려면 'expr' 키워드를 사용함

  (이 안에서 숫자 연산 쓰기)

- 단, 수식과 함께 키보드 숫자 1 왼쪽에 있는 역따옴표로 묶어야 함.

- 다른 기호와 달리 * 기호도 예외적으로 앞에 역슬래시를 붙여줘야 함.

**파라미터 변수:**

파라 미터 변수는 '$ 0', '$ 1' 등의 형태 가짐(숫자 앞에 달러 사인 넣어줘야 함) 이는 실행하는 명령의 부분 하나하나를 변수로 지정한다는 의미. 'yum -y install gftp'를 실행한다고 했을 때, 파라미터 변수는 이와 같음.

``` 명령어 
명령어	   			yum     -y   install   gftp
파라미터 변수       $0      $1    $2       $3
```

명령 전체의 파라미터 변수는 '$*' 로 표현함.



### 7.2.3 if문과 case문

**기본 if문:**

```linux
if [ 조건 ]
then
   참일 경우 실행
fi
```

'[ 조건 ]' 사이의 각 단어에는 모두 공백이 있어야 한다. 

**if~else문:**

참인 경우와 거짓인 경우를 구분해서 실행한다.

``` linux
if [ 조건 ]
then
   참일 경우 실행
else
   거짓인 경우 실행
fi
```

**조건문에 들어가는 비교 연산자:**

산술 비교 연산자는 특수문자를 대신하여 사용

**파일과 관련된 조건:**

if문에서 파일을 처리하는 조건은 다음과 같다.

```linux
파일 조건            결과
-d 파일이름			파일이 디렉터리면 참
-e 파일이름    		파일이 존재하면 참
-f 파일이름			파일이 일반이면 참
-g 파일이름 	    파일에 set-group-id 가 설정되면 참
-r 파일이름 		파일이 읽기 가능이면 참
-s 파일이름			파일 크기가 0이 아니면 참
-u 파일이름			파일에 set-user-id가 설정되면 참
-w 파일이름			파일이 쓰기 가능 상태이면 참
-x 파일이름			파일이 실행 가능 상태이면 참
```

**case~esac문:**

다중 분기

닫아줄 때는 esac라고 씀

 ```linux
#!/bin/sh
case "$1" in
  start)
    echo "시작~~";;
  stop)
    echo "중지~~";;
  restart)
    echo "다시 시작~~";;
  *)
    echo "뭔지 모름~~";;
esac
exit 0
 ```

**AND, OR 관계 연산자:**

조건문에서는 and와 or의 의미를 갖는 관계 연산자를 사용할 수 있다. and는 '-a' 또는 '&&' 를 사용하며, or은 '-o' 또는 '||'를 사용함. '-a'나 '-o' 는 테스트문 안에서 사용할 수 있음. 이 때 특수 문자 앞에는 역슬래시를 붙여줘야 함. 

### 7.2.4 반복문

**for~in문:**

변수에 각각의 값을 넣은 후 do안에 있는 '반복할 문장'을 실행함.

```sh
#!/bin/sh
hap=0
for i in 1 2 3 4 5 6 7 8 9 10
do
  hap=`expr $hap + $1`
done
echo "1부터 10까지의 합: "$hap
exit 0
```

**while문:**

for문과 거의 비슷함.

```sh
#!/bin/sh
while [ 1 ]
do
  echo "CentOS 7"
done
exit 0
```







